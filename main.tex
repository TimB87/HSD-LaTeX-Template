% !TEX root = main.tex
% !TeX program = txs:///arara

%%% we use arara because it makes life easier
%%% arara should work on all platforms
% arara: lualatex: { draft: true, shell: true}
% arara: xindy: {modules: [texindy, page-ranges], codepage: utf8, language: german-duden}
% !arara: --> if changed('idx')
% arara: biber if missing('bbl') || found('log', 'Citation')
% arara: --> || found ('log', 'Please \\(re\\)run Biber')
% arara: makeglossaries if missing('gls') || changed('glo')
% arara: lualatex: { shell: true, synctex: true }
% arara: --> if found('log', 'No file ') || found('log', 'undefined references') || found('log', 'Rerun required') || found('log', 'Rerun to get cross-references')
% arara: lualatex: { shell: true, synctex: true }

%%% we source our input files to get a cleaner main.tex
\input{meta/preambel.tex} % to fragment
%input{meta/packages} % or not to fragment
%input{meta/macros} % that
%input{meta/hyphenations} % is the
%input{meta/options} % question

% bib resources
\addbibresource{literature/literature.bib}

% where to store your images
\graphicspath{{./}{./graphics/}}

% Meta information
\input{meta/authorinfo.tex}

% PDF Meta Data
\hypersetup{%
  pdfinfo={%
    Title={\myTitel},%
    Subject={\myStudiengang},%
    Author={\myAutor},%
    Build=1.1%
  }%
}

%%% this fixes overfull hbox errors in our toc
\makeatletter\renewcommand\@pnumwidth{2em}\makeatother

%\usepackage{tocloft}
% Page references below from
% http://mirrors.ctan.org/macros/latex/contrib/tocloft/tocloft.pdf
%\setlength{\cftfignumwidth}{0.7in} % from p. 9
%\renewcommand{\cftfigpresnum}{\figurename{} } % from p. 9
%\renewcommand{\cftfigaftersnum}{: } % from p. 9

\begin{document}

\pagenumbering{Roman} % Roman page numbering style

\input{content/titlepage/titlepage} % titlepage

\input{content/attachments/lockflag} % lock flag

\setcounter{page}{2} % manually set page counter to page 2
%%% table of content
\setcounter{tocdepth}{3} % define toc depth
\tableofcontents
\newpage

%%% list of abbreviations
\printglossary[type=\acronymtype,title={Abkürzungsverzeichnis}]
\newpage

%%% table of figures
%{%
%  \let\oldnumberline\numberline%
%  \renewcommand{\numberline}{\figurename~\oldnumberline}% adds 'Figure' before the number
%  \listoffigures%
%}
\listoffigures
\newpage

%%% table of tables
%{%
%    \let\oldnumberline\numberline%
%    \renewcommand{\numberline}{\tablename~\oldnumberline}% same as above for tables
%    \listoftables%
%}
\listoftables
\newpage

%%% list of listings
\makeatletter
\renewcommand\l@lstlisting[2]{\@dottedtocline{1}{0.6cm}{7em}{#1}{#2}} % fix spacing between lstlisting and number
\makeatother
\renewcommand{\lstlistingname}{}
\renewcommand{\lstlistlistingname}{Quellcodeverzeichnis} % rename default table of listings name
\renewcommand*{\thelstlisting}{Quellcode~\arabic{lstlisting}} % same as tables and figures
\lstlistoflistings
\newpage

\pagenumbering{arabic} % Arabic page numbering style
\setcounter{page}{1} % reset page counter

% this is where you write your text
\input{content/01-introduction/introduction}
\input{content/02-chapter1/chapter1}
\input{content/03-chapter2/chapter2}
\input{content/99-conclusion/conclusion}

\clearpage % force latex to place anything not yet placed before proceeding
\pagenumbering{Roman} % change back to Roman page numbering style
\setcounter{page}{8}  % change the number accordingly

%%% Glossaries
\newpage
\phantomsection % fixes wrong page numbering
\printglossary[type=main]

%%% print index
\newpage
\phantomsection % fixes wrong page numbering
\addcontentsline{toc}{section}{Index}
\printindex

%%% print bibliography
\newpage
\renewcommand{\refname}{Literaturverzeichnis} % rename "Literatur" to "Literaturverzeichnis"
\phantomsection % fixes wrong page numbering

%\printbibliography % print the bibliography as a whole

%%% you can also split your bibliography by type like this
\printbibliography[keyword=main] % print all cites used throughout our work
\printbibliography[keyword=ctan,heading=subbibliography,title={CTAN Pakete}] % additionally, cite all packages used

%%% appendix
\newpage
\phantomsection % fixes wrong page numbering
\addcontentsline{toc}{section}{Appendix}
\appendix

%%% Attachment A
\includepdf[scale=.7,pages=1, offset=0 -3cm,pagecommand=\section{Prüfungsordnung Wirtschaft}]{content/attachments/po_wiwi.pdf}
%%% this effectively works around the sectioning issue of a multi page pdf
\includepdf[scale=.7,pages=2-7, offset=0 -3cm]{content/attachments/po_wiwi.pdf}

%%% Attachment B
\include{content/attachments/anhang_a}

%%% last page
\input{content/attachments/sworndecleration} % sworn declaration

\end{document}
